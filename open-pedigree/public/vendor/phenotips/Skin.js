if(browser.isIE&&browser.versionMajor<9){new XWiki.widgets.ModalPopup("It appears you are using Internet Explorer version 8 or below. Please install a newer version or a different browser to continue using PhenoTips.",{},{title:"Incompatible Browser"}).showDialog()}document.observe("mousedown",function(a){if(!a.findElement(".suggestItems")&&!a.findElement(".dialog-ontology-browser")){$$(".suggestItems").each(function(b){if(b.__targetField&&(b.__targetField._suggest||b.__targetField._suggestWidget||b.__targetField.__x_suggest)){(b.__targetField._suggest||b.__targetField._suggestWidget||b.__targetField.__x_suggest).clearSuggestions()}})}});document.observe("xwiki:suggest:containerCreated",function(a){if(a.memo&&a.memo.container&&a.memo.suggest&&a.memo.suggest.fld){a.memo.container.__targetField=a.memo.suggest.fld}});document.observe("xwiki:dom:loaded",function(){var a=$("prActionEdit");if(a){$$(".chapter > h2[id]").each(function(c){var b=new Element("a",{"class":"action-edit fa fa-pencil",href:a.href+"#"+c.id,title:"Edit"});c.insert(b)})}if(!$("inline")){return}$$(".chapter.phenotype-info .phenotype-group").invoke("addClassName","collapsible-group");$$(".chapter > h2").each(function(c){var i='<span class="fa fa-plus-square-o fa-lg"></span>&nbsp;';var e=new Element("button",{"class":"tool button secondary",type:"button"}).update(i+"Show");var g='<span class="fa fa-minus-square-o fa-lg"></span>&nbsp;';var h=new Element("button",{"class":"tool button secondary",type:"button"}).update(g+"Hide");var d=new Element("span",{"class":"buttonwrapper show"}).insert(e);var f=new Element("span",{"class":"buttonwrapper hide"}).insert(h);var b=new Element("span",{"class":"expand-tools"}).insert(d).insert(f);c.insert({after:b});[e,h,c].invoke("observe","click",function(j){j.element().up(".chapter").toggleClassName("collapsed")})});$$(".chapter").each(function(b){if(window.location.hash&&b.down(window.location.hash)){b.removeClassName("collapsed")}})});var PhenoTips=(function(d){var a=d.widgets=d.widgets||{};a.FormUtils=Class.create({config:{autosave:{enabled:true,frequency:60,message:"Automatic save"}},initialize:function(){this.form=$("inline");if(this.form){this.isFormDirty=this.isFormDirty.bind(this);this.form._formState=this;var f=this;var e=function(){f.formData=f.form.serialize()};setTimeout(e,0);document.observe("xwiki:document:saved",e);$$("input[name^='action_']").invoke("observe","click",e);window.addEventListener("beforeunload",function(h){if(f.isFormDirty()){var g="Are you sure you wish to leave this page? The data you entered in the form may be lost.";(h||window.event).returnValue=g;return g}return undefined});if(this.config.autosave.enabled){this.timer=new PeriodicalExecuter(this.saveIfFormDirty.bind(this),this.config.autosave.frequency)}}},isFormDirty:function(){return this.form?(this.formData!=this.form.serialize()):false},saveForm:function(e,h){var g=function(){document.stopObserving("xwiki:document:saved",g);document.stopObserving("xwiki:document:saveFailed",f);if(typeof e=="function"){e()}};var f=function(){document.stopObserving("xwiki:document:saved",g);document.stopObserving("xwiki:document:saveFailed",f);if(typeof h=="function"){h()}else{if(typeof e=="function"){(new XWiki.widgets.ConfirmationBox({onYes:e,onNo:function(){}},{confirmationText:"Failed to save the latest modifications. Proceed anyway?",showCancelButton:false})).showDialog()}}};document.fire("xwiki:actions:save",{"continue":true,form:this.form});document.observe("xwiki:document:saved",g);document.observe("xwiki:document:saveFailed",f)},saveIfFormDirty:function(e,f){if(this.isFormDirty()){this.saveForm(e,f)}else{(typeof e=="function")&&e()}}});a.FormUtils.getFormState=function(){return b};var b;var c=function(e){b=new d.widgets.FormUtils()};(XWiki.domIsLoaded&&c())||document.observe("xwiki:dom:loaded",c);return d}(PhenoTips||{}));var disableTitleTab=function(a){a.removeClassName("active");a.update(new Element("a",{href:XWiki.currentDocument.getURL($$('input[name="returnTo"]')[0].value)}).insert(XWiki.currentDocument.page))};var hideElement=function(b){var a=$(b);a&&a.hide()};var cleanupUI=function(a){["document-authors","patient-record-actions"].each(hideElement)};var enableCurrentTab=function(b,a){var c=b.down("h1");var d=b.down("a");b.addClassName("active");d&&d.addClassName("hidden");c&&c.removeClassName("hidden");a&&cleanupUI(b)};document.observe("xwiki:dom:loaded",function(){var d=$("current-tab-id");var a=d&&d.value;if(a){var c=$(a);var b=$("document-title");b&&disableTitleTab(b);enableCurrentTab(c,c.identify()!=="document-title")}});